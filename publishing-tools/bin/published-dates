#!/usr/bin/env python3
import publishing
import argparse
from datetime import datetime, timedelta


if __name__ == '__main__':
    parser = argparse.ArgumentParser(description='''
    Prints each valid date for each node
    ''')
    parser.add_argument('metadata', help='path to project metadata')
    args = parser.parse_args()

    nodes = publishing.load_project_metadata(args.metadata)

    for node in nodes:
        for interval in node['commissioned']:
            start = interval.start.date()
            end = (interval.end or datetime.now()).date()

            for i in range((end - start).days + 1):
                print(node['node_id'], start + timedelta(days=i))
